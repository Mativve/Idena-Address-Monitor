!function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(4),s=n(5),i=n(3);let a,c,u,d=!1;function l(e,t){let n=6e4,o=36e5,s=864e5,i=new Date(e)-new Date,a=Math.floor(i/s),c=Math.floor(i%s/o),u=Math.floor(i%o/n),l=Math.floor(i%n/1e3),f="";if(f=a+"d ",f+=c+"h ",f+=u+"m ",f+=l+"s",t)if(i<=5e4&&i>0&&!d)d=!0,r.notifyMe({title:"VALIDATION",body:"Validation will start in less than "+l+"s"});else{if(i<0&&i>=-15e5)return"Validation in progress";if(i<-15e5)return"Validation ended<br/><small>check your score!</small>"}return f}function f(){a={data:()=>({addresses:[],name:"",id:""}),created(){o.initAddresses(),this.addresses=o.getAdresses()},mounted(){this.renderAddresses()},methods:{renderAddresses:function(){o.getAdresses().then(e=>{this.addresses=e,e&&i.initStatuses(e)})},saveData:function(e){if(this.name.length>0&&this.id.length>0)if("0"==this.id[0]&&"x"==this.id[1]){let e={id:this.id,name:this.name};o.addAddress(e),this.name="",this.id="",this.renderAddresses()}else alert("The address is incorrect!");else alert("Name and address cannot be empty!");return e.preventDefault(),!1},removeAddress:function(e){let t=o.returnAddresses()[e];confirm('Do you want delete "'.concat(t.name,'"?'))&&(o.removeAddress(e),o.saveAddresses(),this.renderAddresses())},moreInfo:function(e){alert(e)},toggleInfo:function(e){this.addresses[e].more=!this.addresses[e].more},convertDate:function(e){return e?function(e,t){let n=new Date(e),o=n.getFullYear(),r=n.getMonth()<10?"0"+n.getMonth():n.getMonth(),s=n.getDate()<10?"0"+n.getDate():n.getDate(),i=n.getHours()<10?"0"+n.getHours():n.getHours(),a=n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes();return"".concat(o,"-").concat(r,"-").concat(s," ").concat(i,":").concat(a," (").concat(l(e,t),")")}(e):"N/D"},dateSince:function(e){return console.log("LAST",e),e?function(e){let t=Date.now()-parseInt(new Date(e).getTime()/1e5),n=Math.floor((new Date-t)/1e3),o=n/31536e3;return o>1?Math.floor(o)+" years ago":(o=n/2592e3,o>1?Math.floor(o)+" months ago":(o=n/86400,o>1?Math.floor(o)+" days ago":(o=n/3600,o>1?Math.floor(o)+" hours ago":(o=n/60,o>1?Math.floor(o)+" minutes ago":Math.floor(n)+" seconds ago"))))}(e):"N/D"}}},Vue.createApp(a).mount("#table")}f(),c={data:()=>({epoch:0,time:"-",timeDate:"-",scoreToInvite:0}),created(){this.getEpochInfo()},mounted(){},methods:{getEpochInfo:function(){fetch("https://api.idena.org/api/epoch/last").then(e=>e.json()).then(e=>{e.result&&(this.epoch=e.result.epoch,this.time=l(e.result.validationTime,!0),setInterval(()=>{this.time=l(e.result.validationTime,!0)},1e3),this.timeDate=new Date(e.result.validationTime).toLocaleString(),this.scoreToInvite=(100*e.result.minScoreForInvite).toFixed(2)+"%")})}}},Vue.createApp(c).mount("#epoch-info"),a={data:()=>({ver:""}),created(){this.ver="0.2"}},Vue.createApp(a).mount("#footer"),u={data:()=>({modal_active:!1,maxSource:0,source:0}),created(){},mounted(){s.init()},methods:{toggleModal:function(){if(this.modal_active=!this.modal_active,this.modal_active){let e=o.returnAddresses(),t="";e.forEach((function(n,o){t+=n.id+","+n.name,o<e.length-1&&(t+="|")})),s.generateCode(btoa(t))}else s.stopScan()},saveFile:function(){o.getAdresses(["id","name"]).then(e=>{console.log(e);let t=JSON.stringify(e),n=new Blob([t],{type:"text/plain"}),o=new Date,r=o.getFullYear(),s=o.getMonth()<10?"0"+o.getMonth():o.getMonth(),i=o.getDate()<10?"0"+o.getDate():o.getDate(),a=o.getHours()<10?"0"+o.getHours():o.getHours(),c=o.getMinutes()<10?"0"+o.getMinutes():o.getMinutes(),u="".concat(r,"_").concat(s,"_").concat(i,"_").concat(a,"_").concat(c);saveAs(n,"iam_"+u+".iam")})},loadFile:function(){let e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept",".iam"),e.click(),e.addEventListener("input",(function(e){let t=e.target.files[0];if(t){let e=new FileReader;e.onload=function(e){let t=e.target.result;t&&(o.saveAddresses(JSON.parse(t)),o.initAddresses(),window.location.reload())},e.readAsText(t)}}))},scanCodeStart:function(){s.scanCode((function(e){if(e.length){let t=atob(e).split("|").map((function(e){let t=e.split(",");return{id:t[0],name:t[1]}}));t&&(o.saveAddresses(t),window.location.reload())}}));let{list:e,count:t}=s.returnSource();this.source=t+1,this.maxSource=e?e.length:0},scanSource:function(){s.sourceChange();let{list:e,count:t}=s.returnSource();this.source=t+1,this.maxSource=e.length},scanCodeEnd:function(){s.stopScan()}}},Vue.createApp(u).mount("#data-manager")},function(e,t,n){"use strict";n.r(t),n.d(t,"removeAddress",(function(){return i})),n.d(t,"returnAddresses",(function(){return a})),n.d(t,"getAdresses",(function(){return c})),n.d(t,"saveAddresses",(function(){return u})),n.d(t,"loadAddresses",(function(){return d})),n.d(t,"addAddress",(function(){return l})),n.d(t,"initAddresses",(function(){return f}));var o=n(2),r=n(3);let s=[];function i(e){let t=[];s.forEach((n,o)=>{o!=e&&t.push(n)}),s=[],s=t}function a(){return s}async function c(e){if(s){let t=s.map(async t=>await o.getAddressInfo(t).then(n=>{let o=["id","name","balance","stake","lastActivity","online","penalty","totalShortAnswers","score","state","more"],r={};return e&&(o=e),o.includes("id")&&(r.id=t.id),o.includes("name")&&(r.name=t.name),o.includes("more")&&(r.more=!1),n.forEach(e=>{null!=e.result&&Object.keys(e.result).forEach(t=>{if(o.includes(t))switch(r[t]=e.result[t]?e.result[t]:"N/D",t){case"totalShortAnswers":e.result.totalShortAnswers.point&&e.result.totalShortAnswers.flipsCount?r.score=(e.result.totalShortAnswers.point/e.result.totalShortAnswers.flipsCount*100).toFixed(2)+"%":r.score="Candidate";break;case"state":"Undefined"==r[t]&&(r[t]="N/D")}})}),r}));return Promise.all(t)}}function u(e){localStorage.setItem("addresses",JSON.stringify(e||s))}function d(){localStorage.getItem("addresses")||u(),s=JSON.parse(localStorage.getItem("addresses")),c().then(e=>{let t=e.map(e=>({id:e.id,online:!!e.online}));r.initStatuses(t)})}function l(e){if(e.name.length>0&&e.id.length>0&&"0"==e.id[0]&&"x"==e.id[1]){let t=s.find(t=>t.id==e.id);t?alert("Duplicate detected! Current name: "+t.name):(s.push(e),u())}}function f(){d()}},function(e,t,n){"use strict";async function o(e){let{id:t}=e,n=["https://api.idena.org/api/address/".concat(t),"https://api.idena.org/api/identity/".concat(t),"https://api.idena.org/api/onlineidentity/".concat(t)].map(async e=>await fetch(e).then(e=>e.json()));return Promise.all(n)}n.r(t),n.d(t,"getAddressInfo",(function(){return o}))},function(e,t,n){"use strict";n.r(t),n.d(t,"compareStatuses",(function(){return a})),n.d(t,"saveStatuses",(function(){return c})),n.d(t,"loadStatuses",(function(){return u})),n.d(t,"initStatuses",(function(){return d}));var o=n(4);let r=[],s=[],i=new Favico({animation:"slide"});function a(){let e=0;r.length==s.length?(r.forEach((function(t,n){t.online!=s[n].online&&0==s[n].online&&e++})),e>0&&(o.notifyMe({title:"Addresses offline status detected",body:"("+e+") account/s status has changed since the last visit. Check them out so you don't lose your iDNAs"}),i.badge(e)),c()):c()}function c(){localStorage.setItem("savedStatuses",JSON.stringify(r))}function u(){localStorage.getItem("savedStatuses")?(s=JSON.parse(localStorage.getItem("savedStatuses")),a()):c()}function d(e){let t=e.map(e=>{let{id:t,name:n,online:o}=e;return{id:t,online:!!o}});r=t,u()}},function(e,t,n){"use strict";function o(e){var t;window.Notification?"granted"===Notification.permission?function(e){console.log("NS");let t=e.title||"",n=e.body||"";new Notification(t,{body:n,icon:"dist/img/icon.png"})}(e):(t=function(e){e.status||console.log(e.msg)},Notification.requestPermission().then((function(e){t("granted"===e?{status:!0,msg:""}:{status:!1,msg:"User blocked notifications."})})).catch((function(e){t({status:!1,msg:"Error"})}))):console.log("Browser does not support notifications.")}n.r(t),n.d(t,"notifyMe",(function(){return o}))},function(e,t,n){"use strict";n.r(t),n.d(t,"returnResultCode",(function(){return d})),n.d(t,"returnSource",(function(){return l})),n.d(t,"scanCode",(function(){return f})),n.d(t,"sourceChange",(function(){return h})),n.d(t,"stopScan",(function(){return g})),n.d(t,"generateCode",(function(){return m})),n.d(t,"init",(function(){return p}));let o,r,s,i,a="",c="",u=0;function d(){return c}function l(){return{list:i,count:u}}function f(e){s.getVideoInputDevices().then(t=>{i=t,r=i[u].deviceId,function(e,t,n){e.decodeFromInputVideoDevice(t,"video").then(e=>{c=e.text,n(e.text),g()}).catch(e=>{console.error(e),c=!1,n(c)})}(s,r,e)}).catch(t=>{console.error(t),e(c)})}function h(){s.reset(),0==u?u=1:1==u&&(u=0),f()}function g(){s.reset(),console.log("Reset")}function m(e){o&&e!=a&&(a=e,o.makeCode(a))}function p(){o=new QRCode("qrcode",{text:"",width:256,height:256,colorDark:"#090909",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.L}),o.clear(),s=new ZXing.BrowserQRCodeReader,console.log("ZXing code reader initialized")}}]);
//# sourceMappingURL=main.js.map